./download.py

######US RNAseq
#RNAseq US specimen level: exp_seq.*US.tsv
#column 3, 8, 9
cut -f 3,8,9 /data/TCGA/icgcFiles/exp_seq.*US.tsv | grep -v icgc_specimen_id > /data/TCGA/icgcFiles/pancan/tmp_exp_seq_specimen_US

python ~/cgDataJing/ICGCscripts/exp_seq_US.py /data/TCGA/icgcFiles/pancan/tmp_exp_seq_specimen_US /data/TCGA/icgcFiles/pancan/exp_seq_specimen_US

python ~/cgDataJing/support/samplingGenomicMatrix.py  /data/TCGA/icgcFiles/pancan/exp_seq_specimen_US 100000 /data/TCGA/icgcFiles/pancan/exp_seq_specimen_US_sampling

#remove all zeros and find 1% rank #1e-8
python ~/cgDataJing/support/Log2xplusTheta.py /data/TCGA/icgcFiles/pancan/exp_seq_specimen_US /data/TCGA/icgcFiles/pancan/tmp_exp_seq_specimen_US_log2 1e-8

sed 2d /data/TCGA/icgcFiles/pancan/tmp_exp_seq_specimen_US_log2 > /data/TCGA/icgcFiles/pancan/exp_seq_specimen_US_log2

##### Phenotype
manual : shared with PCAWG
#manul specimen
cut -f 1,7 /data/TCGA/icgcFiles/specimen.all_projects > /data/TCGA/icgcFiles/pancan/specimen.all_projects.phenotype

cut -f 1,2,5,6,7,8,9,15 donor.all_projects |sed -e 's/$/\tICGC/'> donor.all_projects.phenotype
manual change feature to _cohort

#manul survival
cut -f 1,6,17 ../donor.all_projects |sed 's/$/\tdays/' > new
manual change feature to _EVENT _TIME_TO_EVEN _TIME_TO_EVENT_UNIT
cut -f 1,3,4,5 new  > donor.all_projects.overallSurvival_transfer_specimen

#add primary disease and primary site
python  ~/cgDataJing/ICGCscripts/addPhenotypeByAPI.py /data/TCGA/icgcFiles/donor.all_projects.phenotype new
mv new /data/TCGA/icgcFiles/pancan/donor.all_projects.phenotype

#clinical donor pushdown
python ~/cgDataJing/support/clinicalPushDown.py /data/TCGA/icgcFiles/pancan/donor.all_projects.phenotype  /data/TCGA/PCAWG/mapping_icgcSpecimen_donor /data/TCGA/icgcFiles/pancan/donor.all_projects.phenotype_transfer_specimen

#clinFeature
python ../support/autoStateOrderFeatureFile.py /data/TCGA/icgcFiles/pancan/donor.all_projects.phenotype_transfer_specimen new /data/TCGA/icgcFiles/pancan/donor.all_projects.phenotype_transfer_specimen_clinFeature
mv new 

#stateOrder
python ../support/autoStateOrderFeatureFile.py /data/TCGA/icgcFiles/pancan/donor.all_projects.phenotype_transfer_specimen new
mv new

python ~/cgDataJing/support/autoStateOrderFeatureFile.py  specimen.all_projects.phenotype new
mv new


#SNV
cd /data/TCGA/icgcFiles

snv_parse.bash

cat SNV.header *.donor.xena > SNV.donor.xena
cat SNV.header *.sp.xena > SNV.sp.xena
mv

#SNV gene level --- not a good idea
#python xenaToMatrix.py


# id mapping
cut -f 1,5 specimen.all_projects > mapping_icgc_specimen_donor